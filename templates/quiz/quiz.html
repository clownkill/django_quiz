{% extends 'base.html' %}

{% block title %}{% endblock title %}

{% block content %}

    <div id="app">
        <div class="container mt-5 pt-5">
            <div class="col-md-5 mx-auto">
                <h3>{{ category }}</h3>
                <div v-for="question in questions">
                    <hr>
                    <p>[[question.question]]</p>
                    <div class="form-check" v-for="answer in question.answers">
                      <input @change="checkAnswer($event, question.uid)" :value="answer.answer" class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
                      <label class="form-check-label" for="flexRadioDefault1">
                        [[answer.answer]]
                      </label>
                    </div>
                    <hr>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script>
        var app = new Vue({
            el: '#app',
            delimiters: ['[[', ']]'],
            data() {
                return {
                    category: '{{ category }}',
                    questions: []

                }
            },
            methods: {
                getQuestions(){
                    fetch(`/api/get-quiz/?category=${this.category}`)
                        .then(response => response.json())
                        .then(result => {
                            console.log(result)
                            this.questions = result.data
                        })
                },
                checkAnswer(event, uid){

                    this.questions.filter(question => {
                        answers = question.answers
                        for (var i = 0; i < answers.length; i++){
                            if (answers[i].answer == event.target.value){
                                if (answers[i].is_correct) {
                                    alert('Ура твой ответ правильный!')
                                }else{
                                    alert('О нет. Твой ответ не правильный(')
                                }
                            }
                        }
                    })

                    console.log(event.target.value, uid)
                }
            },
            created() {
                this.getQuestions()
                console.log('Page loaded')
            },
        });
    </script>
{% endblock content %}